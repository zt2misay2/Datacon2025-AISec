“就地取材”(LOL)恶意软件技术约占企业攻击的35%,这些技术利用目标主机上已有的合法操作系统(OS)实用工具来入侵企业。如果简单地移除这些工具,剩余的攻击面将大大减少。不幸的是,这样做可能会严重影响IT/安全运营、用户、应用程序和操作系统本身。基于检测的防御措施(例如,EDR)在应对这些LOL恶意软件技术时非常吃力。这篇博客文章为非技术人员介绍了这一挑战,并概述了一些补救措施的优缺点。
基于检测的端点保护针对LOL攻击常常失败。LOL攻击经常能够逃避其他检测防御,如签名和启发式。基于行为的检测防御(也称为EDR)可以可靠地识别简单的LOL技术并迅速作出反应。这些是高统计置信度匹配。然而,EDR会被模仿合法工作流程、仅在内存中运行和/或在攻击阶段之间引入时间延迟以使一个阶段不与另一个阶段关联形成模式的LOL技术所欺骗。这些代表了统计置信度过低而无法自动响应的情况,需要昂贵的人工专业知识来调查和响应。行为检测对于大约40%采用它的企业来说确实是一种改进。
不能与之共存(LOLbins);也不能没有它们(操作系统实用工具)。在Windows中,禁用WMI会使操作系统瘫痪。必须通过Microsoft Office运行宏和脚本的最终用户会受到禁止选择性操作系统实用工具的影响。大多数IT/安全运营人员依赖PowerShell。然而,网络安全防御者将这些有用的操作系统实用工具称为“LOLbins”,网络对手将其武器化用于攻击企业。
禁止操作系统实用工具还是允许LOLbins?有中间选项。赛门铁克报告了一个观察结果,即80%的操作系统实用工具使用是合法的。完全禁止操作系统实用工具显然会影响合法操作。如果不加以限制,则允许观察到的另外20%的使用作为LOLbins对企业造成损害。通常,企业需要介于“允许所有”和“禁止所有”之间的选项,例如:在需要时限制使用可证明可信的用途,在使用时限制允许的操作。阻止操作系统实用工具启动后的操作可以显著减少攻击面,但并不能完全消除风险。禁止一个实用工具是最安全的。然而,当安全需求与运营需求发生冲突时,这些“中间”选项是最好的。本小节中的以下要点可能不会引起您的兴趣,但会对您的技术人员有吸引力:允许选定的应用程序及其子进程使用选定的操作系统实用工具,在特定情况下暂时暂停某些或全部控制。为了限制操作系统实用工具启动后的行为,在它们开始运行后,控制应该阻止读写敏感文件夹或注册表项、读写其他应用程序的内存、启动高风险应用程序(或根本不启动)。
脚本引擎:如果禁止不可接受,那么怎么办?脚本引擎如PowerShell、CMD、WMI、Visual Basic、Bash/shell、Python、PHP等是操作系统实用工具中的瑞士军刀。它们几乎可以做任何事情。为此,它们需要摄取指令,这些指令可以通过用户界面输入或从脚本文件中读取。对手经常使用脚本引擎执行恶意操作。减少脚本引擎攻击面的企业禁止它们运行(选择性或总是)和/或拒绝脚本引擎对高风险文件夹中的脚本文件进行读取访问。后者比前者更为常见。至于“中间”选项,一些企业使用操作系统设置来限制脚本引擎可以做什么。我们认为不到1%的企业拥有并使用应用程序控制工具来限制脚本引擎可以执行的操作,例如对敏感文件夹、注册表项或其他应用程序的内存进行写操作。一些这样的工具还可以限制脚本引擎可以启动的操作系统实用工具。
维护窗口对小型组织来说可能是个问题。
AppGuard与其合作伙伴Cipher参加了2021年11月3日的FinCyber Today活动。Cipher在展示赞助环节介绍了网络安全威胁的生命周期,并演示了如何检测、阻止和响应网络攻击。总体而言,会议邀请了网络安全领域的知名专家与参会者分享见解和建议。
抵御勒索软件攻击的经验教训在于,勒索软件(或许更应该称为敲诈攻击)挑战了企业IT/安全运营的韧性。预防和检测只是开始,恢复受损系统同样是一个严肃的问题。企业必须审视其备份能力,有些企业需要更积极的备份策略:持续备份、每小时备份或每天备份等。例如,关键任务服务器的风险比普通员工的笔记本电脑要大得多。需要注意的是,网络犯罪分子也会针对备份进行攻击,因此企业应寻求不可变备份。
从受影响的端点收集取证数据会延迟恢复操作,尽管它们并不总能识别出威胁行为者。如果响应计划中没有考虑调查时间,则应进行修订。响应计划还应进行演练,以便能够更快地执行并减少无法挽回的错误。
研究勒索软件行业的洞见显示,敲诈攻击越来越多地由日益复杂的犯罪生态系统实施,这些系统包含多样化的供应链和越来越多的专业角色和职责。他们正在应用工业革命的教训,以变得更加有利可图和更具韧性。不同的专家处理业务的不同部分,甚至还有可以雇佣的主题专家,他们在海量被盗数据中识别有价值的信息,以及那些将这些有价值的信息出售给买家的中间人。
像任何希望增加收入的企业一样,这需要品牌知名度和声誉。这个行业中的个人和组织不能完全隐藏在暗网中。建立他们的品牌对于说服受害者支付赎金至关重要。它证实了承诺的破坏性后果以及受害者顺从后避免该后果的可能性。
所有行业都是目标,他们会攻击任何机会目标。遗憾的是,他们的战术已经发展到不再在第一天就引爆危害。相反,他们会安装一个或多个后门,确认远程连接,并在方便的时候返回。记住专业化,获得访问权限的人越来越不是后来回来变现入侵成果的人。
无数组织在其生态系统中现在都有定时炸弹,稍后会被激活。所有这些专业化导致了更有效的操作和攻击技术,使网络安全防御变得更加困难。从我们的博客中了解更多关于检测恶意软件攻击的挑战以及不完善的检测如何推高IT/安全运营成本。
有关勒索软件业务的更多信息,请观看Intel471的Marutis Lucas的视频。
提高安全运营中心(SOC)效能的建议首先反思一下是什么让运行SOC如此困难是很重要的。首先,检测恶意活动极其困难。单一工具是不够的。SOC必须融合来自众多不同来源的数据。更糟糕的是,尽管有机器学习增强工具的帮助,但仍需要许多有才华的分析师来调查警报。他们的时间大多浪费在误报、太多无关信息、太少相关数据、自动化优化不佳、组织孤岛以及对恶意技术缺乏了解上。更糟的是,潜在的攻击面越来越多样化且不断扩展。警报太多,而分析师太少,技能差距也很大。
绩效指标有时会将重点从应对高风险攻击技术的响应熟练度转移到解决工票的效率上。这个子话题是一个值得研究的大问题。Anton Chuvakin,最受尊敬的SOC市场分析师之一,提出了许多建议。大数据爱好者可能会惊讶地听到他说,一种补救措施是解决检测与预防之间的不平衡。一种永远不能替代另一种。而且,其中一方太少会带来太多风险和过多的SOC工作量。如果通过更有效的努力显著降低警报数量和数据量,改进SOC操作就会简单得多。
就像许多其他IT/安全运营工具一样,SOC工具是由开发人员创建但由不同的运营人员使用的。在可行的情况下,将开发人员轮换到运营角色将有助于更好的自动化小部件或小部件的实现。类似地,考虑为政策/规则创建者和分析师进行轮换。最终,SOC可以通过跨团队边界的轮换和持续学习获得巨大收益,使SOC更加适应性强、敏捷,并更有效地自动化以倍增人员力量。
SOC还可以从重新定义角色中受益,减少“一级”与“三级”分析师定义造成的人为僵化。相反,“角色应该更多地根据个人的技能与他们负责的用例相匹配”。例如,有些人更擅长处理可疑应用程序活动而不是横向移动指示器。
阅读这篇短文或名为“自主安全运营,SOC的10倍转型”的详细白皮书,了解更多关于Anton Chuvakin关于改进SOC的建议。
AppGuard如何帮助您的组织应对勒索软件。勒索软件和其他恶意软件一样,经常逃避检测技术。这并不奇怪。恶意软件可以有几乎无限种形状和伪装。AppGuard是适用于Windows和Linux端点的端点保护软件,可补充现有的基于检测的保护。AppGuard不是检测工具;它采取了一种完全不同的方法。这就是为什么您应该考虑添加这个轻量级工具。阅读这篇博文“企业网络安全中的漏洞:基于检测的保护还不够”以更好地理解这个问题。
没有任何一种检测技术是足够的。为了发现异常,端点内部(EDR)、网络之间(IDS,入侵检测系统)以及与目录和云应用集成(UEBA,用户实体行为分析)都配备了传感器。经验丰富的从业者知道,“更多数据”通常会增加劳动力成本,甚至可能削弱检测效果。这些数据流入SIEM和/或XDR系统,在那里融合来自不同来源的信息。如果没有合适的人才,SIEM和XDR将无法发挥其应有的作用。
减少分诊仪表板的数量并未显著降低警报数量。误报和警报疲劳仍然是普遍存在的问题。调查警报所需的技能差距依然存在。经验丰富的SOC分析师将其视为“时间黑洞”,因为他们必须“追踪许多死胡同”。更糟的是,他们会告诉你,机器学习在数据减少方面的表现并不如人们所希望的那样好。“这是压倒性的!”
事件响应者必须确定每次入侵的范围,加以遏制,并最终恢复到攻击前的状态。在任何一次事件中,可能涉及许多不同的团队。协调和事后努力可能是相当大的且昂贵的工作。
响应不仅限于检测。复杂的生态系统增加了对警报响应的更全面编排的需求,以大幅减少劳动力。安全编排自动化与响应(SOAR)和扩展检测与响应(XDR)都是有前景的帮助。理想情况下,它们会自动完成许多不同工具的工作。怀疑论者担心生态系统过于异构。明智的资金正在等待看这些是否能交付,而不会让一个人比勒索软件更快地瘫痪企业。
预计这些成本将继续增长并无限期存在。量化它们并将它们之间的因果关系相关联是非常具有挑战性的。无论对你来说是什么,它们仅仅取决于在端点被攻破之前,检测工具错过的攻击数量。
最大化人员配置:剧本、演练培训、事件回顾、流程改进和威胁搜寻
大部分网络安全资源用于相对熟悉的攻击技术。如果你的人员没有经过良好的培训和经验,那么你将需要更多的人。但是,人越多,就越需要高效、易于理解的工作流程。成熟的网络安全计划通过剧本、演练培训和事件回顾不断准备和改进他们运作的人员和流程。不幸的是,对于大多数人来说,这些努力是在他们忙于执行其他任务时发生的。
威胁搜寻寻求未被检测到的入侵;目前还没有模式匹配数据。成熟的网络安全计划在大规模、可重复的检测Sec-Ops得到相当优化后,投资于威胁搜寻。这些持续在整个企业范围内寻求检测模式匹配。真正新颖、复杂的威胁需要威胁搜寻,其中要么检测模式尚不存在,要么无法扩展。然而,很少有威胁搜寻计划,许多人永远不会拥有,因为技能和资源有限。预防措施是更实际的投资。
量化和优化上述所有内容是非常困难的。大多数组织需要减少事件数量,以释放资源和人员,然后再追求上述任何一项。没有什么比在端点实时中和恶意代码更能做到这一点,因为事件始于端点。
端点是大多数网络安全成本的根源
我们都知道,绝大多数事件始于端点。几乎没有或根本没有可信的统计数据来量化这一点,这说明了网络安全计划的复杂性。直觉告诉我们,如果被攻破的端点更少,IDS将生成更少的警报,UEBA将检测到更少的被攻破凭据。
添加非检测端点保护以降低您的网络安全成本
选择您的头条新闻或统计数据,结果是一样的。企业网络安全漏洞正在增加。Verizon DBIR的统计数据表明,过去四年中,企业网络安全漏洞的年均增长率约为三分之一。大多数活跃的企业端点保护是基于检测的;这还不够。非检测方法大多未被使用。
忘记在端点保护软件中进行全部或什么都不替换的选择。选择或继续使用足够好的基于检测的端点保护,并添加一个不需要识别恶意软件或其影响的轻量级端点保护工具。它不需要完美。它必须在主机性能和IT/Sec-Ops努力方面是轻量级的。如果它只能减少在端点上错过的部分,它就能缓解上述网络安全防御成本,甚至更多。您的上述成本越高,您添加的非检测保护越不需要完美即可产生净价值。有一些非常有效的选项。这里的关键是不要被追求完美的想法分散注意力。
您添加的内容应在您的基于检测的端点保护做得不好的地方表现出色,例如:
您是否受到已知或未知的未修补应用程序漏洞的困扰?那么您需要执行前应用程序控制或应用程序隔离,以阻止被劫持的应用程序执行有害操作。
生存于土地上的攻击是否逃避了检测?那么您需要禁止高风险的操作系统实用程序,但要以情境化的方式。换句话说,对手不能使用危险的Windows实用程序,但您的IT/Sec-Ops人员和工具在需要时可以使用。在某些情况下,完全禁止过于破坏性。隔离是下一个最佳选择。
代码注入技术是否造成了严重破坏?内存防火墙功能可以阻止内存读写。(前面提到的同一项Ponemon调查发现,73%的受访企业没有这样做)。其他控制可以阻止加载恶意或危险但合法的DLL文件。