过度依赖检测技术来缓解恶意软件风险会以两种方式对企业造成负面影响:成功的恶意软件攻击和更高的网络安全运营成本。之前,我们探讨了为什么仅靠检测是不够的。现在,我们将从定性的角度审视网络安全运营成本,以帮助回答以下问题:如果通过添加非检测保护功能在端点实时中和更多的恶意软件攻击,哪些方面可以得到缓解?下面的每一部分都代表了一个重要的节省领域。在阅读这些内容时,请知道各种形式的攻击面减少技术可以降低这些成本。
企业的网络安全成本受到所使用防御措施的复杂性以及攻击数量的影响。Ponemon 2020年的研究发现,68%的企业在过去两年中经历过“一次或多次成功破坏数据资产和/或IT基础设施的端点攻击”(连续第三年增加),并且68%的企业表示“过去12个月的攻击频率有所增加”。上述统计数据基于几乎完全依赖基于检测工具的网络安全防御。它们也反映了老练的对手在对目标发动攻击前,经常对其恶意软件进行一系列检测工具的测试。
被攻破的端点必须进行修复。恶意软件攻击者很少发送与哈希值完全匹配的恶意对象。机器学习(ML)检测技术力求统计性地分辨好坏。对手知道这一点,并故意采取措施增加不确定性。一些攻击能够以高统计信心被识别并在造成任何损害之前被中和。有些攻击则完全未被端点工具检测到。但还有一些攻击,其统计信心太低而无法自动干预。这样的攻击会造成需要清理的混乱。它们停留的时间越长,造成的混乱就越大。在某些情况下,EDR/EPP可以通过自动生成的脚本或可执行文件来清理主机。其他情况则需要人工干预,由安全运营团队为IT运营团队创建支持工单。大多数企业缺乏足够训练有素的人员来进行清理工作,这通常要求重新镜像被攻破的端点。演练培训可以帮助解决这个问题。参与者可以学习如何进行必要的清理,而不是简单地重新镜像。
被攻破和可能被攻破的凭据必须重置。凭据是对手最渴望获取的数据类型。一旦获得,对手会利用它们窃取其他凭据,在端点上执行原本无法执行的操作,并用它们来攻破其他端点。操作系统凭据通过多种不同方法被盗。这些工具变得如此易于使用,以至于凭证盗窃技术不再只针对大型企业,而是几乎所有的企业。对手会窃取浏览器缓存中的云密码,有时还会从Windows注册表中窃取应用程序密码。很少有企业对这些进行集中管理。重置凭据可能会非常耗时。双因素认证可以显著降低这些风险。那些没有对所有凭据进行集中管理的企业,其重置成本更高。不幸的是,应该重置的凭据并没有被重置。这些成本很难量化。
横向移动:从一个端点到多个再到广泛传播。从一个被攻破的端点开始,今天的远程控制恶意软件工具可以在几分钟内攻破其他端点。所有潜在被攻破的端点都可能需要修复。入侵者专注于寻找和窃取特权凭据,尽管他们也会使用其他技术。主要市场分析师认为,人类控制的攻击实际上无法阻止,因为对手的工具非常难以检测,而且他们的用户可以根据遇到的情况进行适应。横向移动可以悄无声息但缓慢,也可以快速但嘈杂。有时,网络安全防御者可以检测到事件,但无法迅速采取行动加以遏制。其他时候,对手会在攻击阶段之间插入延迟,以完全避开检测,因为一个动作不会与其他动作关联,因为它们发生在数小时或数天之后。所有这些策略以及其他策略都增加了必须监控和调查警报的专业分析人员的数量,以及寻找未检测到的入侵。理想情况下,猎手了解您的生态系统的独特性,否则他们会追逐许多误报和漏报。行业分析师一致认为:大多数威胁猎手不具备这种知识。为了发现并遏制横向移动,需要全职分析师以及来自各个IT/Sec-Ops团队的兼职协助。量化所有这些成本是复杂的。
来自EDR、XDR、SIEM、IDS、UEBA的事件响应和警报疲劳。前面提到的Ponemon调查显示,58%的端点警报最终是误报。
关键基础设施、端点保护和零日攻击是当前网络安全领域的重要议题。行业分析师指出,企业主要依赖或完全依赖基于检测的网络安全防御技术。然而,他们的报告也揭示了仅靠基于检测的工具是不够的原因。根据Verizon DBIR的数据,从2019年到2020年,违规事件数量增加了33%,达到5,258起,而2018年至2019年间这一数字增加了96%。Mandiant在2020年的网络事件调查中发现,65%的受攻击组织在第一周内没有发现攻击。尽管机器学习被广泛应用,但它并没有神奇地填补这些昂贵的检测空白。本文接下来将探讨为什么检测未能达到预期效果,并简要介绍企业需要什么以及如何实现。
SolarWinds Orion供应链攻击提供了两个重要教训。一些目标组织的日志数据中包含许多该攻击的指标,但他们的安全运营中心直到行业指南发布后才解读这些数据。这是基于检测的网络安全防御技能差距的一个典型案例。其他组织被发现保留日志数据的时间太短,有些受影响的公司在七天后就删除了数据。
利用现有环境进行攻击时,威胁行为者常常模仿合法工作流程以愚弄检测系统。行业分析师称,这类攻击是最难高置信度检测的。请注意,最后一个限定词。渗透测试人员和实际威胁行为者公开表示,他们故意使攻击树与合法工作流程相似以避免被检测。
威胁行为者通过修改已知恶意文件来愚弄检测系统。文件操作方法多种多样。可以轻易使用“打包器”修改可执行文件而不破坏其功能,然后将其上传到VirusTotal,后者会返回数十个检测供应商的假阴性结果。这个短视频展示了某人如何修改2017年的WannaCry可执行文件,使AV/EDR工具无法识别上传到VirusTotal的文件。
对手仍然可以通过不同的编程语言重新编译源代码来绕过检测。将文件上传到云端进行分析也不够,因为恶意软件有时会暂时休眠或在虚拟环境中表现不同以逃避检测。
机器学习(ML)不是人工智能;它只是统计学。基于ML的检测工具擅长检测以前见过的和非常类似的东西。避开它们只需要一点额外的努力。从根本上说,ML可以被愚弄,因为它不能利用抽象。它统计上将事物与其他事物相关联,而不知道每个事物是什么。因此,向基本攻击树中添加无关紧要的事物会破坏相关性,从而混淆识别。例如,对手通过在阶段之间插入暂停、插入不必要的阶段,以及将合法文件中的无害二进制片段附加到恶意文件上来修改先前被识别的攻击,以愚弄ML。有许多反ML技术。有些甚至使用ML工具来研究如何愚弄基于ML的检测工具。在恶意软件攻击头条新闻的背后,往往是被愚弄的基于ML的检测工具。
禁用的端点代理听不到也报告不了任何信息。Mandiant发现,在2020年的网络事件/违规调查中,有9.8%涉及Mitre ATT@CK的T1562技术,该技术终止或使端点安全工具失效。Ryuk、REvil、SolarWinds等许多攻击都使用了这种技术。离线大约一个小时的代理通常不会被调查,即使被注意到也是如此。攻击者在这段时间内可以相当活跃。这强调了实时阻止攻击的重要性。
当攻击未立即被阻止时,凭据首先被盗,随后其他端点也会被攻陷。2021年Verizon DBIR发现,凭据是最常见的被盗数据类型。所有调查的企业违规事件中有超过40%涉及被盗凭据。第一个端点之后会有许多其他端点。对手手中有一些工具可以自动化查找、捕获和使用特权Windows凭据来攻破域管理员凭据。这些工具可以快速且嘈杂地运行,也可以缓慢且隐蔽地运行。2021年Verizon DBIR还观察到,凭据盗窃不仅针对大型企业。攻击工具使得这样做变得太容易了。有些工具专门设计用来规避EDR检测。警告:试图理解这些规避方法的工作原理可能会导致脑动脉瘤。
分析师称,人为控制的攻击几乎总是能击败检测工具。人为控制的攻击要求对手至少在一个目标主机上运行一个远程控制进程。攻击工具本身是模块化的,由许多不同的攻击组成,可以按需选择。一旦他们发现正在运行的主机保护,就可以调整他们的行动。不同的攻击载荷有的安静,有的嘈杂,对某些防御更有效,对其他防御则不然,并具有多种禁用或规避检测的方法。
一些行业分析师称,此类攻击总是能够成功渗透企业。然而,这种描述是轶事性的,并非统计意义上的推断。这些广泛的断言基于对攻击者迅速获得反馈的理解,即哪些方法有效,哪些无效。趋势表明,威胁行为者越来越多地使用攻击工具,如下面图表所示,因为它们成功地击败了基于检测的防御。Cobalt Strike最初是一个渗透测试工具,是进行人为控制攻击的威胁行为者的首选武器(图表来自Mandiant M-Trends 2021)。