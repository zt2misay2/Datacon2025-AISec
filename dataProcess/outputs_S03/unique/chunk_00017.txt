When conducting lateral movement within an internal network, attackers often try to capture login hashes and passwords from the target machine. However, this method is not always feasible because some machines may lack this information or it may be cleared or encrypted. As a result, hackers have turned to simulating identity authentication scenarios in the Windows system environment, such as Outlook login, elevation of authorization (User Account Control), or lock screen unlocking. By forging these scenarios, they can deceive users into providing their credentials.
This article introduces several methods of system credential phishing attacks, aiming to help readers better protect their systems and network security by understanding these techniques. One such tool is FakeLogonScreen, an internal network credential phishing tool written in C#. To use it, simply run it on the target machine, and it will automatically display a forged Windows login screen, minimize other application windows, block most shortcut keys, and support automatic password verification. Another similar tool is SharpLocker.
虽然大多数网络安全漏洞涉及技术问题,但网络安全最终还是一个人的问题。人为因素使企业面临风险,削弱了技术的有效性,但也可以弥补技术无法解决的问题。一些网络问题最好通过人性化解决方案或至少考虑人的状况来处理。我们分享了一些组织可以实施的专业提示,以减轻安全漏洞。这将有助于缓解网络安全计划中许多层级的工作量和压力
更多专业提示,请下载我们的信息图

寻找暴露的杂项错误
根据Verizon DBIR 2019报告,“杂项错误”是金融、保险、教育、医疗保健、信息、公共管理、零售和技术服务领域前三大违规模式之一。专业提示:只有冗余的、主动的流程才能解决这些人为造成的症状。您的员工应维护并寻求“错误”Top 10/25/100列表,并与同行合作维护这些列表。优先处理高影响漏洞。寻找方法进行隔离以减少暴露

依赖专家进行渗透测试,而不是冒牌货
人们倾向于熟悉和舒适的事物。一些渗透测试人员从同一个技巧袋中抽取,而不是系统地针对整个可能的风险范围。许多企业难以区分专家和冒牌货。专业提示:利用威胁框架,如Mitre Att@ck。选择威胁情报提供商时,部分应基于他们如何从可能性缩小到可能性。除非确定其非常出色,否则避免使用同一家渗透测试公司。不同渗透测试人员之间的差异可能很大,一个可能发现其他人遗漏的漏洞。了解AppGuard如何与关键网络安全框架对齐,请参阅我们的最新白皮书

构建基于角色的网络安全培训计划
有效的员工网络安全准备培训可以减轻主要风险。给接待员和IT系统管理员提供相同的培训可能比不培训更糟糕。他们对风险(太低)和缓解措施(太高)的看法差异很大。集中培训很快会被遗忘,警惕性的暂时提高会回到粗心大意的状态。人的问题需要人的解决方案。专业提示:个性化员工网络安全准备培训。通过模拟钓鱼等手段挖掘数据,找出高风险员工。使用针对不同角色定制的内容。使准备成为一个持续的过程,教导、激励并强化

由于COVID-19危机,大多数员工预计将在传统环境之外工作。此外,随着远程工作因各种原因成为常态,组织可以利用这个机会建立适合传统和远程环境的强大网络安全态势。重要的一点是,网络安全挑战不仅涉及技术,而且以人为本的解决方案也是必不可少的。适用于一个组织的最佳方案可能并不适合其他组织
众所周知,端点文件夹中的文件可能会对你造成伤害。大多数恶意文件经常被攻击者重复使用,基于检测的防御措施可以很好地处理这些文件。然而,有经验的攻击者会使用工具修改恶意文件以逃避检测。因此,企业需要补充其基于检测的防御措施,采用不需要识别恶意文件就能击败它们的工具。这篇博客旨在向高管解释他们的技术人员需要他们从高层次上理解的内容。

博客摘要
忘记全面的应用控制
为什么用户空间文件夹比系统空间文件夹风险更大
最低权限:最终用户应无提升权限运行PC
高风险应用程序使某些系统空间文件夹成为高风险
工作站与服务器的风险及缓解措施
文件夹中的恶意文件,仅检测是不够的
你需要对高风险文件夹内的恶意文件进行默认拒绝
为什么应用控制既过于复杂又不足以应对恶意文件
AppGuard是解决端点文件夹中恶意文件的更简单、更好的解决方案

忘记全面的应用控制
部署和操作应用控制是繁重的任务。尽管许多供应商指定了令人头疼的“允许列表”,但仍然如此。而且更糟糕的是,这还不够;但这又是另一个话题。重要的是要知道,应用控制旨在限制从端点上的每个文件夹启动和加载可执行文件和脚本文件。不像聪明的高管们那样对高风险和低风险事物区别对待,应用控制通常对所有文件夹一视同仁,从而产生了大量不必要的工作。

为什么用户空间文件夹比系统空间文件夹风险更大
记住,风险不仅仅是潜在影响,还包括影响的可能性。用户空间是微软为笔记本电脑和台式机创造的一个概念。它由没有提升权限的最终用户可以保存和更改文件的文件夹组成。系统空间则由操作系统(OS)不允许最终用户在没有提升权限的情况下保存和更改文件的文件夹组成。最初,操作系统和应用程序文件属于系统空间...谷歌多年前通过Chrome改变了这一点,使得Chrome可以安装到用户空间,这样最终用户可以在企业环境中使用Chrome而无需IT将其安装到系统空间。现在,用户空间通常充满了合法和恶意的应用程序。对手总是将恶意文件“丢弃”到用户空间。例如,如果最终用户用Microsoft Word打开一个武器化的文档或访问一个黑客攻击浏览器的网站,这些被劫持的应用程序可能写入磁盘的任何文件在最终用户缺乏提升权限的情况下通常无法进入系统空间。但它们总是可以写入用户空间。虽然系统空间中恶意文件的潜在影响更大,但可能性要小得多。现在,随着合法和潜在恶意的可执行文件和脚本文件都在用户空间中,企业面临着一个危险的攻击面。

最低权限:最终用户应无提升权限运行PC
让我们暂时偏离一下,讨论一个重要原因。上述用户空间和系统空间的区别应该让你更清楚地认识到,坚持要求最终用户不要以管理员身份登录工作站的重要性。这会使系统空间更容易被对手访问。告诉你的IT/Sec-Ops人员,你支持这个原因。

高风险应用程序使某些系统空间文件夹成为高风险
企业服务器更多地被应用程序而不是最终用户使用。Windows Server上存在用户空间文件夹。它们仍然代表一个攻击面,因为任何被劫持的应用程序都可以写入其中。然而,在服务器上,某些应用程序必须被允许写入系统空间的文件夹。如果这些应用程序存在较高的被攻破风险,那么这些系统空间文件夹也必须被视为高风险。你的安全控制必须减轻来自用户空间和这些高风险系统空间文件夹的文件启动和加载风险。其他文件夹也存在一些风险,但较小。

工作站与服务器的风险及缓解措施
被攻破的服务器的影响通常远大于工作站。你可能会认为在工作站上被攻破的可能性要高得多。这是真的,但那些花时间修改其恶意文件的复杂对手更喜欢针对服务器。幸运的是,由于服务器主要用来托管应用程序而不是不守规矩的最终用户,因此可以更积极地锁定服务器以减轻风险,同时不太可能干扰合法活动。

文件夹中的恶意文件,仅检测是不够的
你的检测工具试图区分好文件和坏文件。有些会上传签名或文件本身以进行云分析,以区分好坏。简而言之,这些检测方法对大多数文件是成功的,但在对手花时间使用修改过的文件以逃避检测时就显得力不从心了。对手也有云服务。与VirusTotal不同,每次文件提交都会通知检测供应商,对手的云服务不会这样做。熟练的对手在攻击前就知道他们的恶意软件被检测到的可能性。

你需要对高风险文件夹内的恶意文件进行默认拒绝