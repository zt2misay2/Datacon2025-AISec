只能应用一些零信任原则来限制被隔离应用程序在多个维度(如文件、注册表、内存、子进程、权限和网络)上的读写操作。微软的应用程序防护是唯一具备此功能的端点保护平台(EPP)产品,并免费提供给所有Windows企业许可证持有者,但使用率不到1%。企业也可以从其他供应商处购买各种实现。
将零信任原则应用于高风险应用程序意味着不允许它们执行潜在恶意操作。这些操作与企业网络安全堆栈中可能拥有的四种类型工具的关系如下所示。应用程序控制分为预执行和后执行(也称作peri执行),因为很少有应用程序控制工具支持后执行,那些支持后执行的工具被认为太难使用。尽管如此,我们可以看到每种工具对高风险应用程序可能应用的零信任缓解措施。
涵盖/遗漏的零信任原则:
- 应用程序控制(预执行)
- 应用程序控制(后执行)
- 行为检测(EDR)
- 隔离
将文件下载到磁盘:否、是、否、是
启动/加载磁盘上的文件:是、否、可能、否
修改磁盘上已有的关键系统或应用程序文件:否、是、可能、是
读取/窃取操作系统或其他应用程序内存中的数据:否、否、可能、是
将恶意指令注入另一个应用程序的内存:否、否、可能、是
将恶意库加载到另一个应用程序的内存:是、否、可能、是
添加/修改注册表键:否、是、可能、是
启动并使用操作系统实用程序:是、否、可能、是
启动/使用无文件进程:否、是、可能、是
接收并执行来自远程对手的命令:否、否、可能、是
传输被盗数据:否、否、否、是
行为检测(也称作EDR)不是零信任机制。许多“可能”答案需要解释。一个AppJacking攻击可能涉及十个阶段。如果在第三阶段发生检测,并且该检测具有高统计置信度,那么行为检测代理将在一秒钟内终止攻击中识别的所有进程。这可能发生在第四到第六阶段之前,这意味着第七到第十阶段永远不会发生。预防第七到第十阶段可能相当于上表中会被阻止的一个或多个行。但这些都是反应而非零信任拒绝。行为检测代理不会明确阻止第七到第十行的动作。相反,终止相关进程会导致这些原本会发生的行为被终止。从默认拒绝的角度来看,行为检测不是零信任机制。零信任机制本质上是确定性的:允许/拒绝特定动作。
在端点内添加零信任到网络安全防御对于缓解AppJacking风险和降低劳动力成本至关重要。优秀的医疗保健包括预防措施,如疫苗以避免感染,以及早期检测方法以治疗疾病。企业的网络安全防御也是如此,两者结合更好。检测工具可以击败可识别的恶意软件攻击。零信任工具不是通过识别恶意软件,而是通过阻止其有害行为来击败攻击。一种工具可以阻止另一种工具错过的,或者比另一种工具更早地阻止。这是优秀的网络安全防御。
通过零信任工具阻止检测工具错过的内容,并在检测工具反应之前阻止一些可检测的攻击,添加一个在端点内应用零信任的工具可以减少网络安全堆栈中多个检测工具的警报数量,从而减轻相应网络安全团队的工作负担。此外,端点内的零信任控制在实时阻止攻击,这通常发生在端点被攻破之前。这样的工具可以在检测工具在端点被攻破后做出反应时减轻那些必须修复端点的人的工作负担。
隔离看起来很好但很少部署,因为大多数实现都非常痛苦。这个话题值得单独一篇博客文章。简而言之,有几种不同的隔离工具。主机沙箱不同于网络或云沙箱,它是一个垃圾场,几年前就被企业端点移除了。微软提供的“应用程序防护”采用了进程虚拟化。这要求修改应用程序源代码,以便应用程序能够穿透边界在整个端点上工作。很少有应用程序经过这样的修改。“应用程序防护”随Windows企业许可证免费提供,但不到1%的企业选择使用它。Bromium基于驱动的隔离工具也遭受了与主机沙箱相同的命运。几乎没有EPP包含隔离功能。必须从第三方获取这些功能。
AppGuard提供了企业所需以补充检测防御的零信任能力。AppGuard结合了“隔离”和“预执行应用程序控制”,相当于上表中总结的因AppJacking导致的有害操作的所有“是”条目,详细信息见底部表格。
与其他方案相比,AppGuard的操作工作量较小。AppGuard几乎不受过去和现在的应用程序控制或隔离工具的操作困难的影响。AppGuard确实需要一些前期调优,如果受保护主机进行了重大更改,有时后期也需要调优。在策略未强制执行的短暂发现阶段,可以看到一个或少数几个合法应用程序需要进行策略调优。在策略强制执行的第一周或两周内,可能还需要一些额外的调优。根据观察,部署代理中不到1%的策略与供应商指定的默认策略不同,这种调优工作量很小且很短暂。
在端点内部应用零信任原则将帮助企业网络安全计划调整其优先级,以适应COVID-19带来的新现实。这些现实是由近乎萧条的经济预期驱动的,要求网络安全防御用更少的资源做更多的事情。这种方法与过去五年或更长时间内所谓的“检测与响应”范式背道而驰:收集更多数据、监控和调查更多警报,并通过更多的传感器、工具、集成和人员来实现这一切。任何添加或更改的选择都必须更倾向于节省成本而不是增加保障效益。为了帮助理解,我们将探讨一些对你来说可能是新的零信任方法的好处。阅读本文后,高管应与其技术团队讨论并验证本文内容。
端点零信任是微观的;企业零信任是宏观的。你所读到或听到的几乎所有内容都不是关于端点零信任的;几乎全部都是关于企业零信任的。应用于两者的原理基本上相同。它们只是在不同的上下文中应用“信任但验证”的概念。企业零信任——不信任企业内的事物;端点零信任——不信任端点内的事物。从企业的角度来看,端点零信任可能看起来像是一种疫苗。
企业零信任可以减少你的“检测与响应”工作量。企业零信任对试图访问企业网络、Web应用程序、服务器或其他资源的用户、设备以及在较小程度上的应用程序应用“信任但验证”的挑战。其基本假设是恶意行为者可能控制任何设备、用户账户或用户应用程序会话。高保证度的用户身份验证和设备或应用程序的完整性检查提供了一些保证,即后续活动不会有害。这些检查中的任何失败都会导致终止、隔离和权限丧失。这使得最终可能被证明是恶意的持续活动更少。
剩下的或允许的活动随后将受到“检测与响应”工作流程的处理:警报、监控、调查和响应“可疑”行为。使用入侵检测系统的分析师寻找横向移动。其他人部署实体用户行为分析(EUBA)工具来检测异常账户使用情况。SIEM分析师试图检测之前未检测到的情况。如此等等!
零信任可以扑灭不可信行为以减少“检测与响应”工作量。当涉及人类或不断变化的情况时,事情不可能完全锁定。必须允许某些可能最终变得恶意的行为。检测和响应工具必须识别这些恶意活动。企业可能会禁止没有双因素认证的商业智能Web应用程序访问、未经认证设备的远程桌面会话以及不在白名单上的端点的API调用。扑灭得越多,需要监控异常和恶意迹象的持续活动就越少。这代表了零信任的最大价值,尤其是在COVID-19之后,节约成本将是必要的。
端点零信任则是在微小的地方驱动巨大的效果。毫无疑问,你熟悉渗透测试。它在不同层次上进行:渗透企业、渗透端点、渗透单个应用程序以查看其是否足够安全以暴露在外。考虑这些例子如何代表不同范围,从微观到宏观。
前面提到的“检测与响应”工作流程以及其他工作流程监控的大多数活动,最终都起源于一个或多个被攻破的端点。这些宏观检测是在恶意软件攻击导致端点被攻破之后发生的。这些结果来自端点上的应用程序和实用程序让恶意软件进入或在其后造成损害。端点内的零信任期望应用程序和实用程序会变坏,并使用控制措施,不允许被劫持的应用程序下载/执行恶意软件;从其他应用程序的内存中窃取凭据;允许来自其他端点的远程执行攻击等。扑灭这些可以防止在IDS、EUBA和其他宏观检测工具寻求的宏观妥协之前的微观妥协。因此,在端点内部中和“微观”可以在它们在企业层面显现之前中和“宏观”。
具体而言,端点内部的零信任如何做到这一点是一个很大的话题,最好单独讨论。现在,想象一下这对你的网络安全操作的许多不同层次和工作流程的影响。有多少不同的部分依赖于端点发生的事情?能释放多少劳动力?
根据身份盗窃资源中心(ITRC)上个月发布的《2021年回顾报告》,我们推断出几乎一半的2021年数据泄露是由于端点保护失败造成的。这个推断是合理的,但需要承认这个数字最多只是近似值。尽管如此,它对于设定2022年的网络安全堆栈和安全运营优先级仍然有用。需要在端点提供更多保护。
为什么这个端点保护失败的数字很重要
没有人的预算足够支付所有可能的风险缓解措施。决策者必须选择哪些措施可能以最低的成本产生最大的影响。他们已经为多层次的网络安全堆栈提供了资金,以实现纵深防御。人员成本通常远高于工具成本。所有组织至少在每个端点上都有一个基于软件的防御(例如,传统的防病毒软件、端点保护平台)。其他层次部署在端点之前(即边界)、周围(例如,入侵检测、实体用户行为分析等)和之后(SIEM、XDR等)。来自端点防御的警报也应被视为涉及端点防御之后的资源,因为直到分析师调查后才会阻止或终止任何事情。而且,不要忘记补救和其他事件后的成本。
完美的预防性端点保护将大大减少“周围”和“之后”层的人员工作量。相反,更多的端点保护失败会增加“周围”和“之后”的成本。这也增加了风险,因为当人员追查大量相对低影响的事件时,他们无法处理高影响的事件。警报疲劳也会降低人员效率,从而增加风险。
决策者总是在众多潜在的网络安全投资中挣扎选择。声称2021年46%的数据泄露是由于端点保护失败造成的,这意味着有了这个数字比没有这个数字更容易选择改进措施。这样做可以改善整体风险缓解并降低IT/安全运营成本。
我们如何得出这个数字以及为什么它可能低估了原因
该报告将“网络攻击”数据泄露的原因分类为:“钓鱼/短信钓鱼/BEC”、“勒索软件”、“恶意软件”、“非安全云环境”、“凭证填充”、“未修补的软件漏洞”、“零日攻击”、“其他-未指定”,以及“NA”(未定义)。我们排除了未归因的泄露事件,然后将“勒索软件”(33%)、“恶意软件”(13%)、“未修补的软件漏洞”(0.4%)和“零日攻击”(0.4%)的个别原因合并到我们得出的“端点保护失败”数字(46%)。这些数字仅适用于那些归因了根本原因的数据泄露事件。
钓鱼攻击可能涉及社会工程、恶意软件或两者兼有。我们无法说有多少比例的钓鱼攻击涉及恶意软件。多年来,Verizon数据泄露调查报告背后的专家告诉我们,事件/泄露提交往往存在问题。一些钓鱼攻击可能涉及恶意软件,但未被分类为恶意软件。同样,许多甚至大多数组织缺乏快速识别由于“未修补的软件漏洞”或“零日攻击”导致的事件/泄露所需的取证能力。因此,由于端点保护失败而导致的数据泄露很可能被低估了。
“零日攻击”的数字并不令人惊讶。它们一直占很小的比例,因为还有许多其他方式可以破坏企业。然而,同比增幅达到了300%。不过,2021年确实比2020年报告了更多的零日漏洞。
2021年勒索软件和恶意软件导致的数据泄露增加
报告显示,2021年勒索软件导致的数据泄露比2020年增加了122%。同样,恶意软件导致的数据泄露增加了34%。
2021年数据泄露比2020年增加了84%
ITRC的数据表明,2021年和2020年分别有1,613起和878起由网络攻击引起的数据泄露。这相当于增长了83.7%。许多人认为这是由于更多的人在家工作,这意味着对端点保护的依赖更大。
三分之一的泄露事件未归因于根本原因
这对上述所有数字意味着什么?我们只能猜测。然而,这确实说明了很多潜在信息有助于每个人做出更好的决策。你可能已经注意到,公开的数据泄露报告很少具体说明哪些网络安全防御失败及其方式。
恶意软件“检测差距”使每个人都处于风险之中
我们认为,企业防御过于依赖检测技术,而这些技术未能识别恶意文件和行为的几乎无限种类。更糟糕的是,太多组织依赖低端的基于检测的防御。有些防御效果远好于其他。但即使是最好的防御也会失败。而且,最好的防御越来越多地在检测和应对复杂的恶意软件攻击时,是在一个或多个端点和凭证被攻破后数小时到数月才进行。这种情况发生得越晚,清理成本和财务影响就越大。