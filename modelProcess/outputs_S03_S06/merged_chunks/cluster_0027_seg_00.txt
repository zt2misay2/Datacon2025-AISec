In the previous issue, we introduced concepts such as protocols and cryptographic protocols, and discussed the technical specifications of the IPSec VPN protocol based on national and industry standards for cryptography. We also interpreted the evaluation and verification methods of the IPSec VPN protocol through practical cases. In this issue, we will continue to explore with Dr. Yang the related content on the compliance verification of the IPSec protocol. IPSec Protocol Compliance Verification
(1) IPSec VPN Device Protocol Configuration Check
When confirming the compliance of the IPSec protocol, one can start by checking the relevant configurations of the IPSec VPN device, such as encryption algorithms, authentication algorithms, and operating modes. This step helps to preliminarily confirm whether the device uses commercial cryptographic algorithms and protocols for data transmission. The following figure (Figure 1) shows the IPSec protocol configuration page of a certain IPSec VPN device, which includes the used cryptographic algorithms and operating mode. The 3GPP consortium released the 5G-AKA, the 5th generation mobile communication system's authentication and key agreement, through technical specification (TS) 33. 501. This protocol introduces public key encryption to hide users' SUPI, enhancing the privacy of mobile users. However, 5G-AKA is vulnerable to linking attacks from active attackers, which can put user privacy at risk. A paper from USENIX SECURITY 2022, "Privacy-Preserving and Standard-Compatible AKA Protocol for 5G," addresses this vulnerability by proposing an improved 5G-AKA method. This new method, based on key encapsulation mechanisms, protects privacy while remaining compatible with existing 5G standards. It can resist linking attacks without requiring changes to the user's SIM card or the current 5G service network deployment. Next, we will describe the specific process of 5G-AKA. The 5G-AKA protocol includes an initialization phase and a challenge-response phase. In the initialization phase, the UE uses the HN's public key and the ECIES encryption algorithm to encrypt the SUPI, obtaining SUCI, and sends it to the HN. In the challenge-response phase, the HN randomly selects a challenge (RAND) and calculates AUTN, which contains MAC and the hidden SQN_HN.