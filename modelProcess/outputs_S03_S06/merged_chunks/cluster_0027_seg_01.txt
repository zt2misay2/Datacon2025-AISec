Upon receiving RAND and AUTN, the UE first checks the message's validity using MAC. If the check fails, the UE returns a MAC_Failure message. Next, the UE verifies the message's freshness by comparing SQN_HN and SQN_UE. If this check fails, the UE returns a Sync_Failure and AUTS message, and uses the AUTS message to resynchronize with the HN. Finally, when all checks pass, the UE calculates the response value RES and the anchor key K_seaf, and sends the response value RES to the HN.