您还可以观看这段视频
5 - 白宫应对网络安全技能短缺
拜登政府本周启动了国家网络安全劳动力和教育战略,旨在解决美国合格网络安全专业人员短缺的问题。 普遍认为这是一个严重的问题。 据美国国家标准与技术研究院的 Cyberseek 数据显示,美国约有663,000个空缺的网络安全职位,相当于约30%的职位空缺率。 (来源:Cyberseek,2023年8月1日)国家网络安全劳动力和教育战略基于四个支柱:通过向每个人提供学习网络安全的机会,使所有美国人都具备基本的网络安全技能;从基础教育到大学,包括社区学院和技术学校,彻底改革网络安全教育;通过促进基于技能的招聘等方式,扩大和增强美国的网络安全劳动力;通过降低招聘和入职障碍等方式,加强联邦网络安全劳动力。 多个联邦机构参与了这项倡议,还有私营部门公司、非营利组织和教育机构。 要获取更多详细信息,请阅读白宫的公告、国家网络安全劳动力和教育战略主页和60页的项目描述。 以上代表了通过漏洞利用进行的AppJacking,这些漏洞在野外被利用时还没有补丁(即零日攻击)。 人们永远不知道是否有其他零日攻击正在发生。 这种情况永远不会结束。

AppJacking概括了终端内的操作。

为什么这些操作对你很重要?显然,基于检测的保护远非完美。行为工具依赖于模式匹配检测数据来确定应用程序的操作是否合法或恶意。统计置信度的高低决定了所有差异。聪明的攻击者知道这一点,并通过增加额外的行为和对象以及阶段之间的延迟来降低统计置信度。最好的情况是,这意味着三级分析师需要分析和调查更多的警报,IT-Ops也需要清理混乱。最坏的情况是,检测完全被避开。然而,如果这些AppJacking操作不被允许,那么攻击就可以在不需要检测(即识别)的情况下被击败,这就是我们总结它们的原因。

AppJacking执行以下概括的操作:
- 将文件下载到磁盘:而不是让被劫持的应用程序自己执行所有需要的恶意指令,而是下载并运行其他东西来完成这些操作。
- 启动/加载磁盘上的文件。
- 修改磁盘上已有的关键系统或应用程序文件。
- 修改合法内容以获得优势。
- 确保恶意软件在主机重启时启动。
- 读取/窃取操作系统或其他应用程序内存中的数据。
- 窃取凭据和/或有价值的数据。
- 将恶意指令注入另一个应用程序的内存:通过填充大量恶意指令,将相同或另一个应用程序变成黑客工具。
- 某些应用程序(如Chrome)比其他应用程序受到更多监控,使用Chrome劫持另一个较少监控的应用程序来执行大部分恶意操作可以更加隐蔽。
- 将恶意库加载到另一个应用程序的内存中。
- 添加/修改注册表键:确保恶意软件在主机重启时启动。
- 禁用选定的安全控制。
- 启动并使用操作系统实用程序:磁盘上的恶意文件可能会被检测到,操作系统实用程序可以做恶意文件本来会做的事情。
- 启动/使用无文件进程:磁盘上的恶意文件可能会被检测到,或者无法写入磁盘,可以向这些进程中加载大量的恶意指令。
- 接收并执行来自远程对手的命令:人工控制的操作可以根据终端进行调整,远程使用Cobalt Strike等工具。
- 传输被盗数据:中国就是通过这种方式窃取了数万亿美元的知识产权。

上表并不旨在包罗万象。理想情况下,应用零信任原则可以缓解AppJacking风险。上面“AppJacking操作”表中的每一行都描述了被劫持的应用程序用于对企业造成伤害的不同方式。应用零信任意味着使用安全控制来阻止这些操作。这种方法的好处在于不必确定什么是异常或恶意的。不需要检测!结果是在端点被攻破之前,在生成检测警报之前,在三级EDR分析师必须调查之前,提供实时保护。

不幸的是,大多数EPP代理缺乏这些功能,或者它们拥有的功能过于繁琐。

端点保护代理对AppJacking的缓解

下表描述了不同通用EPP功能及其可能或不可能缓解AppJacking风险的方式。稍后,我们将看看它们在零信任原则方面能做什么和不能做什么。

EPP功能
- 补丁管理:不再被认为是标准的EPP功能;消除或屏蔽软件漏洞,使应用程序无法被利用;不能缓解其他两种AppJacking方法(即设计缺陷、代码注入)
- 反利用:将代码注入应用程序,力求防止通过漏洞利用进行的AppJacking;一旦应用程序被劫持则不起作用;没有已知的实际贡献的实证证据;一些分析师质疑其在野外是否真的有效
- 签名检测:如果在加载到目标应用程序内存之前识别出恶意文件,则可以防止AppJacking;文件操纵以逃避检测非常容易,因此这很少能防止AppJacking
- 机器学习文件检测:分析文件中的恶意指令,如果检测到恶意则防止AppJacking;使用多种混淆技术来逃避检测;一些EPP将文件上传到云端进行分析,但由于隐私和数据泄露问题,不会对潜在的武器化文档进行此类操作
- 应用程序控制:仅应用了一些零信任原则;所有实现都具有预启动功能,但很少有后启动功能;预启动阻止可执行文件、脚本和库文件的启动/加载,这些文件可以执行复杂的有害操作;后启动(也称作peri启动)限制应用程序的文件/文件夹读写操作;由于复杂性,不到0.1%的企业使用此功能
- 行为检测(也称作EDR):使用机器学习和启发式方法检测恶意行为;如果检测具有高统计置信度,则在毫秒内终止进程并将文件隔离;当检测的统计置信度较低时,会为三级分析师生成警报以进行调查和响应,而AppJacking操作则继续进行;如果警报被证实有效,有时会有自动清理,有时需要手动清理;谷歌的Project Zero在其许多零日漏洞利用分析中说,“这类漏洞利用很可能很难通用检测”,或者他们不对检测提出建议