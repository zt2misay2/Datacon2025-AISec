关键基础设施、端点保护和零日攻击是当前网络安全领域的重要议题。行业分析师指出，企业主要依赖或完全依赖基于检测的网络安全防御技术。然而，他们的报告也揭示了仅靠基于检测的工具是不够的原因。根据Verizon DBIR的数据，从2019年到2020年，违规事件数量增加了33%，达到5,258起，而2018年至2019年间这一数字增加了96%。Mandiant在2020年的网络事件调查中发现，65%的受攻击组织在第一周内没有发现攻击。尽管机器学习被广泛应用，但它并没有神奇地填补这些昂贵的检测空白。本文接下来将探讨为什么检测未能达到预期效果，并简要介绍企业需要什么以及如何实现。
SolarWinds Orion供应链攻击提供了两个重要教训。一些目标组织的日志数据中包含许多该攻击的指标，但他们的安全运营中心直到行业指南发布后才解读这些数据。这是基于检测的网络安全防御技能差距的一个典型案例。其他组织被发现保留日志数据的时间太短，有些受影响的公司在七天后就删除了数据。
利用现有环境进行攻击时，威胁行为者常常模仿合法工作流程以愚弄检测系统。行业分析师称，这类攻击是最难高置信度检测的。请注意，最后一个限定词。渗透测试人员和实际威胁行为者公开表示，他们故意使攻击树与合法工作流程相似以避免被检测。
威胁行为者通过修改已知恶意文件来愚弄检测系统。文件操作方法多种多样。可以轻易使用“打包器”修改可执行文件而不破坏其功能，然后将其上传到VirusTotal，后者会返回数十个检测供应商的假阴性结果。这个短视频展示了某人如何修改2017年的WannaCry可执行文件，使AV/EDR工具无法识别上传到VirusTotal的文件。
对手仍然可以通过不同的编程语言重新编译源代码来绕过检测。将文件上传到云端进行分析也不够，因为恶意软件有时会暂时休眠或在虚拟环境中表现不同以逃避检测。
机器学习（ML）不是人工智能；它只是统计学。基于ML的检测工具擅长检测以前见过的和非常类似的东西。避开它们只需要一点额外的努力。从根本上说，ML可以被愚弄，因为它不能利用抽象。它统计上将事物与其他事物相关联，而不知道每个事物是什么。因此，向基本攻击树中添加无关紧要的事物会破坏相关性，从而混淆识别。例如，对手通过在阶段之间插入暂停、插入不必要的阶段，以及将合法文件中的无害二进制片段附加到恶意文件上来修改先前被识别的攻击，以愚弄ML。有许多反ML技术。有些甚至使用ML工具来研究如何愚弄基于ML的检测工具。在恶意软件攻击头条新闻的背后，往往是被愚弄的基于ML的检测工具。
禁用的端点代理听不到也报告不了任何信息。Mandiant发现，在2020年的网络事件/违规调查中，有9.8%涉及Mitre ATT@CK的T1562技术，该技术终止或使端点安全工具失效。Ryuk、REvil、SolarWinds等许多攻击都使用了这种技术。离线大约一个小时的代理通常不会被调查，即使被注意到也是如此。攻击者在这段时间内可以相当活跃。这强调了实时阻止攻击的重要性。
当攻击未立即被阻止时，凭据首先被盗，随后其他端点也会被攻陷。2021年Verizon DBIR发现，凭据是最常见的被盗数据类型。所有调查的企业违规事件中有超过40%涉及被盗凭据。第一个端点之后会有许多其他端点。对手手中有一些工具可以自动化查找、捕获和使用特权Windows凭据来攻破域管理员凭据。这些工具可以快速且嘈杂地运行，也可以缓慢且隐蔽地运行。2021年Verizon DBIR还观察到，凭据盗窃不仅针对大型企业。攻击工具使得这样做变得太容易了。有些工具专门设计用来规避EDR检测。警告：试图理解这些规避方法的工作原理可能会导致脑动脉瘤。
分析师称，人为控制的攻击几乎总是能击败检测工具。人为控制的攻击要求对手至少在一个目标主机上运行一个远程控制进程。攻击工具本身是模块化的，由许多不同的攻击组成，可以按需选择。一旦他们发现正在运行的主机保护，就可以调整他们的行动。不同的攻击载荷有的安静，有的嘈杂，对某些防御更有效，对其他防御则不然，并具有多种禁用或规避检测的方法。
一些行业分析师称，此类攻击总是能够成功渗透企业。然而，这种描述是轶事性的，并非统计意义上的推断。这些广泛的断言基于对攻击者迅速获得反馈的理解，即哪些方法有效，哪些无效。趋势表明，威胁行为者越来越多地使用攻击工具，如下面图表所示，因为它们成功地击败了基于检测的防御。Cobalt Strike最初是一个渗透测试工具，是进行人为控制攻击的威胁行为者的首选武器（图表来自Mandiant M-Trends 2021）。