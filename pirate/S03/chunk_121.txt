只能应用一些零信任原则来限制被隔离应用程序在多个维度（如文件、注册表、内存、子进程、权限和网络）上的读写操作。微软的应用程序防护是唯一具备此功能的端点保护平台（EPP）产品，并免费提供给所有Windows企业许可证持有者，但使用率不到1%。企业也可以从其他供应商处购买各种实现。
将零信任原则应用于高风险应用程序意味着不允许它们执行潜在恶意操作。这些操作与企业网络安全堆栈中可能拥有的四种类型工具的关系如下所示。应用程序控制分为预执行和后执行（也称作peri执行），因为很少有应用程序控制工具支持后执行，那些支持后执行的工具被认为太难使用。尽管如此，我们可以看到每种工具对高风险应用程序可能应用的零信任缓解措施。
涵盖/遗漏的零信任原则：
- 应用程序控制（预执行）
- 应用程序控制（后执行）
- 行为检测（EDR）
- 隔离
在端点内添加零信任到网络安全防御对于缓解AppJacking风险和降低劳动力成本至关重要。优秀的医疗保健包括预防措施，如疫苗以避免感染，以及早期检测方法以治疗疾病。企业的网络安全防御也是如此，两者结合更好。检测工具可以击败可识别的恶意软件攻击。零信任工具不是通过识别恶意软件，而是通过阻止其有害行为来击败攻击。一种工具可以阻止另一种工具错过的，或者比另一种工具更早地阻止。这是优秀的网络安全防御。
通过零信任工具阻止检测工具错过的内容，并在检测工具反应之前阻止一些可检测的攻击，添加一个在端点内应用零信任的工具可以减少网络安全堆栈中多个检测工具的警报数量，从而减轻相应网络安全团队的工作负担。此外，端点内的零信任控制在实时阻止攻击，这通常发生在端点被攻破之前。这样的工具可以在检测工具在端点被攻破后做出反应时减轻那些必须修复端点的人的工作负担。
隔离看起来很好但很少部署，因为大多数实现都非常痛苦。这个话题值得单独一篇博客文章。简而言之，有几种不同的隔离工具。主机沙箱不同于网络或云沙箱，它是一个垃圾场，几年前就被企业端点移除了。微软提供的“应用程序防护”采用了进程虚拟化。这要求修改应用程序源代码，以便应用程序能够穿透边界在整个端点上工作。很少有应用程序经过这样的修改。“应用程序防护”随Windows企业许可证免费提供，但不到1%的企业选择使用它。Bromium基于驱动的隔离工具也遭受了与主机沙箱相同的命运。几乎没有EPP包含隔离功能。必须从第三方获取这些功能。
AppGuard提供了企业所需以补充检测防御的零信任能力。AppGuard结合了“隔离”和“预执行应用程序控制”，相当于上表中总结的因AppJacking导致的有害操作的所有“是”条目，详细信息见底部表格。
与其他方案相比，AppGuard的操作工作量较小。AppGuard几乎不受过去和现在的应用程序控制或隔离工具的操作困难的影响。AppGuard确实需要一些前期调优，如果受保护主机进行了重大更改，有时后期也需要调优。在策略未强制执行的短暂发现阶段，可以看到一个或少数几个合法应用程序需要进行策略调优。在策略强制执行的第一周或两周内，可能还需要一些额外的调优。根据观察，部署代理中不到1%的策略与供应商指定的默认策略不同，这种调优工作量很小且很短暂。
The top ten mitigation strategies from the U.S. National Security Agency counter various techniques that APT attackers might use. These measures set priorities for organizations to minimize business impact and are built on the NIST Cybersecurity Framework functions, which aim to manage cybersecurity risks and promote a defense-in-depth approach. The strategies are ranked based on the effectiveness of known APT tactics, and additional strategies and best practices are needed to address new tactics as they emerge.
Cybersecurity protection keywords: Identify, Protect, Detect, Respond, Recover
Update and upgrade software immediately
Keywords: Identify, Protect
Apply all available software updates, automate the process as much as possible, and use update services provided directly by vendors. Automation is crucial because attackers often study patches and exploit methods shortly after a patch is released. These "N-day" exploits can be as destructive as zero-day vulnerabilities. Vendor updates must also be genuine to ensure the integrity of the content. If applications are not patched quickly and thoroughly, attackers can carry out intrusions within the defender's patch cycle.
Secure privileges and accounts
Keywords: Identify, Protect
Assign privileges based on risk exposure and maintain them as required for operational purposes. Use Privileged Access Management (PAM) solutions to automate credential management and fine-grained access control. Another method of managing privileges is through tiered administrative access, where each higher tier provides additional access but to fewer individuals. Create procedures to securely reset credentials such as passwords, tokens, and badges. Controlling privileged accounts and services is essential to prevent attackers from gaining administrative access to high-value assets and moving laterally across the network.
供应商表示：“不幸的是，Kaseya的VSA产品已成为一次复杂的网络攻击的受害者。”据信与俄罗斯威胁组织“REvil”有关的黑客利用SQL漏洞和身份验证绕过手段劫持了Kaseya VSA的本地部署。这导致众多企业和托管服务提供商客户的未知数量的笔记本电脑、台式机和服务器上的文件被加密勒索。从这次代价高昂（对某些人来说是灾难性的）的网络事件中，我们再次得到了一个宝贵的教训：从外部获取数据的应用程序有可能被对手劫持。所有企业的IT/Sec-Ops人员必须对这些高风险应用程序应用遏制控制措施，以防止此类攻击得逞。
关于本地Kaseya VSA你需要知道，它是一种IT远程监控和管理（RMM）解决方案，用于由IT和网络管理员在企业计算设备上安装和修补软件、管理备份、自动化其他IT流程以及远程解决和排除IT问题。这类工具需要在每个计算设备上运行具有提升权限的软件代理。在这次攻击中，各个计算设备上的单独代理没有被利用，而是两台或更多服务器上运行的VSA软件遭到破坏，然后指示代理安装并运行恶意软件。
Kaseya SaaS未被攻破，它像Kaseya VSA一样，依赖于每个计算设备上运行的代理。然而，Kaseya SaaS代理由Kaseya的云指导，似乎这些客户没有受到这次攻击的影响。
高管们应该了解如何减轻此类网络攻击的风险。当你阅读和听取关于这次攻击的细节时，你会听到关于SQL注入和身份验证绕过的信息。这些只是导致不幸结果的手段。无论哪种方式，对手都会劫持你基础设施中的关键应用程序，并用它来对付你。有一类安全控制措施，每个企业都应该全面使用：遏制和隔离。遏制限制了高风险应用程序对其所驻留的端点的其余部分可以做什么。隔离限制了端点的其余部分对同一主机上的应用程序或对象可以做什么或从中获取什么。
在这次攻击中，当被劫持的Kaseya VSA应用程序试图写入不应写入的地方时，遏制控制会实时阻止这些操作。在这次攻击中，一个零日漏洞被利用来劫持Kaseya VSA应用程序。或者，在这次攻击中没有发生的情况是，另一个应用程序可能已被破坏并用于向Kaseya VSA应用程序注入恶意代码。隔离控制可以阻止这种技术。
还有另一种方法可以实现相同的保护效果：一种执行预执行和执行期间功能的应用程序控制工具。“peri-”意味着它在操作期间对Kaseya VSA等应用程序强制执行某些读写规则。不幸的是，对于大多数能够执行此功能的网络工具而言，规则集可能非常复杂且难以创建和维护，因为这些细粒度的规则必须随着应用程序随时间的变化而变化。很少有企业（不到5%，甚至可能不到1%）实施执行期间的应用程序控制工具，因为它们给日常运营带来了负担。
AppGuard本可以保护受害者免受其被劫持的Kaseya VSA软件的侵害。AppGuard破解了在添加强大保护的同时避免执行期间应用程序控制困难的代码。没有哪个供应商能像AppGuard那样使遏制和隔离安全控制措施如此易于实施和维护，或如此有效。正如SolarWinds供应链攻击、Microsoft Exchange Server Proxylogon攻击以及过去一年中许多其他重大头条恶意软件攻击一样，AppGuard被发现是区分受害者和胜利者的关键。
AppGuard的方法可能与你熟悉的方法大不相同，它通过阻止不允许的操作来中和攻击，而无需识别恶意软件，并通过自动适应活动上下文的控制来避免过去技术的缺陷。这与为你或其他人部署的大多数东西形成对比，后者只有在识别出恶意内容时才能成功防御攻击（并且更麻烦的是，如果识别出的话）。
今天的对手非常擅长伪装他们的攻击，通常看起来像是无害的日常活动。Kaseya聘请调查此事件的Mandiant公司此前报告称，在他们2020年进行的65%的调查中，IT/SecOps团队在一周内未能发现攻击。这给攻击者留下了太多时间潜伏在企业内部，有时甚至是在光天化日之下隐藏。如果你要保护银行或军事基地，请将AppGuard视为你的锁和安全许可，而基于检测的工具如EDR或NGAV则是你的安全摄像头和保安。即使间谍可以欺骗你的保安，他们也需要合法的许可才能进入金库。
AppGuard可以添加到任何现有的网络基础设施中，显著提高对逃避基于检测工具的恶意软件攻击的保护，例如这次Kaseya攻击。它轻量级、易于操作，并在端点上实现实时阻止恶意软件攻击，从而减少警报、横向移动、端点修复，甚至减轻应用程序补丁管理的压力。