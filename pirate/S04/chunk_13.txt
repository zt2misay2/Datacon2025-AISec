在3月7日，VEEAM发布了一篇知识库文章，描述了该公司提供的几款软件中的一个新的CVE漏洞。此漏洞可能导致凭据泄露和远程代码执行。VEEAM是一家专注于虚拟化基础设施和基于云的应用程序的弹性的软件公司。其主要软件VEEAM Backup & Replication为虚拟机、物理服务器、云基础设施或应用程序提供备份解决方案，并支持多种类型的备份存储库来存储备份（如CIFS、S3桶等）。  

OVHcloud中提供了多种使用VEEAM软件的方式：  
第一种是Hosted Private Cloud中的Veeam Backup Managed选项，由OVHcloud完全管理并已应用了与此漏洞相关的缓解措施。  
第二种是在备份服务器上安装并使用由OVHcloud提供的VEEAM Enterprise选项来获取VEEAM许可证。在这种配置下，按使用量计费，并且您可以使用VEEAM Backup & Replication的所有功能并完全管理基础设施。  
最后一种是在备份服务器上自带许可证进行安装。这种情况下，您将完全管理备份基础设施。  
在后两种选项中，您可以在VEEAM Backup & Replication软件中添加托管私有云、专用服务器和其他服务。  

CVE-2023-27532影响到监听VEEAM服务器TCP 9401端口的Veeam.Backup.Service.exe。它允许未经身份验证的用户请求存储在VEEAM数据库中的凭据，还可以在备份服务器上远程执行命令。攻击者可以使用这些凭据访问受备份软件保护的所有服务器。  

尽管利用此漏洞并不简单，但至少有一个勒索软件组织正在积极利用它，并且许多利用代码已公开。因此，未来几周内自动化攻击的数量可能会增加。  
在观察到的操作方法中，攻击者利用该CVE漏洞获取备份解决方案覆盖的基础设施的凭据（例如：vSphere凭据等），以便从库存中删除所有虚拟机并最终加密所有备份。然后，他们将要求赎金以获取解密密钥。目前，这种利用仅发生在直接暴露在互联网上的运行Windows操作系统的备份服务器或备份代理上。  

所有早于12.0.0.1420 P20230223或11.0.1.1261 P20230227版本的VEEAM Backup & Replication都存在漏洞。如果不受信任的IP可以访问9401端口，则该服务存在漏洞。  

为了保护您的基础设施，我们强烈建议您更新备份软件。您可以在官方文档中找到修补后的二进制文件。  
在等待更新期间，为了防止未来的漏洞暴露，我们建议应用以下配置：  
首先，避免将备份基础设施直接暴露在不安全的网络（如互联网）上。  
当您在服务器上安装VEEAM时，它会配置防火墙以允许任何连接到VEEAM端口，而不限制远程地址。因此，所有端口都可以从任何地方直接访问。  
我们建议应用防火墙规则，将端口限制为最少的主机。  
为此，请确保Windows Defender防火墙设置为阻止所有不符合规则的入站连接。  
然后，确保所有使用的端口仅能从您信任的服务器访问。对于最佳配置，请参阅官方文档。  
您应该看到防火墙规则现在已限制为您配置的IP。  
最后，如果您不使用挂载服务器，我们建议完全阻止9401端口。  
由于该利用使用了合法访问，因此无法在虚拟化基础设施或备份存储库级别进行缓解。因此，必须确保使用这些基础设施的组件的安全性。  

如果您认为自己已被攻破，我们强烈建议您尽快联系OVHcloud支持，以评估可能恢复数据的解决方案。  
2023年7月24日，AMD发布了一份安全公告，披露了其Zen2计算机处理器微架构中的一个漏洞。该漏洞被AMD命名为“跨进程信息泄露”，也被称为“Zenbleed”。该漏洞被标记为CVE-2023-20593，并被AMD评为中等严重程度。此问题允许攻击者在特定情况下访问CPU处理的敏感信息。所有运行在基于AMD Zen2处理器上的软件，包括虚拟机、沙箱、容器和进程，都会受到影响。利用此漏洞的软件可能已经存在，预计基于此漏洞的攻击很快就会发生。  

所有AMD Zen2 CPU，包括EPYC Rome处理器，都存在此漏洞，具体包括：  
- AMD Ryzen 3000系列处理器  
- AMD Ryzen PRO 3000系列处理器  
- AMD Ryzen Threadripper 3000系列处理器  
- 带有Radeon显卡的AMD Ryzen 4000系列处理器  
- 带有Radeon显卡的AMD Ryzen PRO 4000系列处理器  
- 带有Radeon显卡的AMD Ryzen 5000系列处理器  
- 带有Radeon显卡的AMD Ryzen 7020系列处理器  
- 第二代AMD EPYC “Rome”处理器  

对OVHcloud产品的影响  
针对这一事件，我们立即审查了安全公告和技术信息，并确定了以下对我们产品可能产生的影响。  
- 公共云：所有产品未受影响  
- 托管私有云：所有产品未受影响  
- 网站托管与域名：所有产品未受影响  
- 裸机云：ADVANCE-1, Advance STOR-1, Advance STOR-2, Game-1, Game-2, HGR-SDS-2, HGR-HCI-4, HGR-HCI-5, HGR-HCI-6, Infra-2, Rise-GAME-1, Rise-GAME-2, Scale-1, Scale-2, Scale-3（仅限由AMD Zen2驱动的服务器）可能受影响  
- 其他商用系列专用服务器：未受影响  

如何缓解漏洞：  
- 客户自行缓解：通过固件包更新在启动时加载修补的微代码。此解决方案将通过操作系统更新（例如linux-firmware包）触发处理器微代码的更新。您可以在您的操作系统编辑器或社区分发更新包后进行操作。此方法取决于您的发行版或操作系统编辑器，并且只有在AMD提供了适当的微代码时才有效。目前，只有“Zen2 Rome”和“Zen2 Castle Peak”可以通过此方法覆盖。  
- 使用更新的内核缓解：当无法通过固件更新包获得微代码更新时，您可以更新内核版本，通过配置所谓的“chicken bit”来禁用故障处理器功能以实现缓解。这可能会影响系统的性能。此解决方案将在操作系统编辑器回传新版本的Linux内核时包含。我们建议客户优先采用此缓解策略，因为这是最有效的，不依赖于硬件供应商是否提供更新的微代码。  
- 作为替代方案，您可以手动设置chicken bit而不依赖内核更新。然而，我们不推荐这种可能对系统有风险的解决方案。  

OVHcloud发起的缓解措施  
OVHcloud团队正在努力实施透明的解决方案，确保客户的修补微代码以透明的方式更新。这些解决方案将逐步部署到我们的服务器上。目前正在评估两个主要选项。  
- 使用OVHcloud iPXE：当客户使用标准的OVHcloud网络启动（最常见的配置）时，引导加载程序可能会加载微代码更新。一旦可用，通过OVHcloud客户界面重启服务器将导致在从磁盘启动之前加载更新的微代码，从而缓解漏洞。但是，如果您不使用OVHcloud网络启动系统直接从磁盘启动，则不会应用缓解措施，您应该考虑依赖操作系统级别的缓解措施。  
- 使用UEFI：UEFI固件更新可能在启动时更新CPU微代码。包括修补微代码的UEFI固件更新可能会在未来几个月内由主板制造商提供。一旦可用，OVHcloud将在任何新交付的服务器上包含此修补微代码。客户随后可以通过联系支持请求UEFI固件更新。  

作为潜在受影响服务器的管理员，我该怎么办？  
首先，使用我们团队开发的工具（仅限Linux）检查您的服务器是否受到此漏洞的影响：  
# wget https://raw.githubusercontent.com/speed47/spectre-meltdown-checker/master/spectre-meltdown-checker.sh  
# sh spectre-meltdown-checker.sh --variant zenbleed --explain  
如果工具显示“NOT VULNERABLE”（未受影响），则您已经安全，无需进一步行动。  
如果工具显示“VULNERABLE”（受影响），则应评估您面临威胁的程度。  
2021年12月可能会被铭记为Apache库“Log4j”中的一个漏洞造成严重破坏的月份。随后的攻击被称为“Log4Shell”、“Log4js”、“LogJam”等，该漏洞被追踪为CVE-2021-44228。它影响了互联网上使用Apache的众多产品和云服务。大多数受影响的软件实例托管在Linux服务器上，但有一小部分运行在Windows服务器上。该漏洞允许远程代码执行（RCE），即AppJacking攻击。拥有易受攻击服务器的组织可以确信AppGuard将帮助他们抵御基于“Log4j2”或“Log4Shell”的攻击。  
Log4j会是最严重的吗？行业杂志和渴望关注的“专家”往往会夸大其词。但对于Log4j来说，这些可能不是夸大。互联网上的许多内容都依赖于Log4j。Apache和其他机构推荐的缓解措施显然不容易或快速完成。CISA主任Jen Easterly将Log4J漏洞描述为“我整个职业生涯中见过的最严重的漏洞之一，如果不是最严重的话。”  
幸运的是，对于AppGuard的客户，特别是那些有较高风险的Linux服务器的客户，他们已经很好地保护了自己免受这个Log4j风险的影响。仅检测永远不够。每当漏洞和恶意软件成为头条新闻时，基于检测的端点保护供应商通常会发布新的攻击或妥协指标数据。这证实了总有攻击是现有的检测数据尚未涵盖的。具有Log4j漏洞的企业需要非基于检测的保护来增强他们的基于检测的工具。  
AppGuard对Linux服务器的保护。默认策略确保Apache软件进程不会对其主机造成伤害。如果对手利用了易受攻击的Apache应用程序或组件，AppGuard将不允许被利用的进程修改关键文件、向关键区域添加恶意文件、向其他进程注入恶意代码、从内存中窃取凭证和/或运行从互联网下载的恶意文件。  
AppGuard对Windows服务器的保护。为了让Apache运行，默认的AppGuard策略必须从禁止Java改为限制Java。我们通常建议对所有面向互联网的进程应用限制。典型的部署会对Java和相应的Apache软件应用程序应用限制。这防止它们生成的进程修改主机的关键部分、将恶意文件/数据添加到敏感位置、从低权限文件夹启动潜在的恶意文件、向其他应用程序的内存注入恶意代码和/或从内存中抓取凭证。  
Log4Shell提醒我们应用程序不能被信任（也称为AppJacking）。几乎所有恶意软件攻击中常见的一个因素是，对手基本上是利用终端上的应用程序来对抗企业。他们利用易受攻击或薄弱的应用程序将其主机下载恶意代码或对主机执行有害操作（点击AppJacking链接获取更多信息）。这一直是AppGuard命名及其在终端内应用零信任原则以保护企业免受自身应用程序侵害的概念的灵感来源。