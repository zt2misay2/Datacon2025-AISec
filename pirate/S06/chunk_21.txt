什么是机密计算？在过去的几十年里，IT行业主要关注保护存储或传输中的数据。数据加密和解密已成为一种普遍服务，几乎所有用户和公司都在使用，例如用于安全连接的VPN或微软用于加密存储设备的BitLocker。但在处理数据时会发生什么？实际上，在数据处理步骤中，数据没有真正的安全保障。这就是机密计算变得必要的地方。  
为什么机密计算很重要？2017年6月，IT界处于警戒状态，世界各地的IT部门加班应对一个有可能摧毁基础设施核心的威胁：Meltdown和Spectre。这些关键硬件漏洞的目标是CPU，影响了自1995年以来生产的使用AMD/Intel处理器的PC、笔记本电脑、服务器和其他设备。这些攻击允许恶意程序访问内存以及其他程序和操作系统。这个例子说明了为什么在数据处理期间进行数据加密和解封也很重要。  
机密计算如何工作？以下解释基于英特尔SGX（Intel® Software Guard Extensions），这是OVHcloud在其配备Intel Xeon E-2288G CPU的服务器系列中提供的技术。此外，OVHcloud还提供适用于AMD Zen架构EPYC处理器的AMD Infinity Guard。机密计算通过在安全飞地中运行数据和应用程序来保护它们。飞地是由CPU（可信）保护的内存中的隔离区域，其中包含敏感的应用程序数据。这些内存区域中的代码和数据只能在飞地内部访问。这将数据和代码隔离起来，防止未经授权的访问，即使计算基础设施受到损害。Intel® SGX技术代表了机密计算的主要实现之一，它允许组织将软件和数据与底层基础设施（硬件或操作系统）隔离开来。  
结果是：用户现在可以在不受信任的基础设施、公共云和其他托管环境中运行敏感的应用程序和数据。这使用户对其安全边界内外的应用程序和数据的安全性和隐私性有了更大的控制权。  
合作伙伴如何从OVHcloud的机密计算产品中受益？机密云产品为客户和合作伙伴提供了以下好处：  
- 保护使用中的数据和应用程序  
- 帮助保护知识产权（IP）  
- 用户可以对整个数据生命周期启用加密  
- 避免对正在处理的数据进行攻击和未经授权的访问  
- 用户对云中的数据拥有完全控制权  
对于在处理过程中处理敏感数据的每个用户来说，机密计算都很重要。借助机密计算，数据是安全的，并且您可以在操作期间将敏感数据与更常见的数据分开。例如，使用敏感数据训练机器学习模型。  
通过机密计算，合作伙伴可以为需要安全环境的客户提供一系列产品和解决方案。这可能是金融服务或其他处理个人数据领域的解决方案。  
有关OVHcloud机密计算产品组合的更多信息，请访问：  
https://www.ovhcloud.com/en/bare-metal/uc-confidential-computing/  
请访问  
https://www.ovhcloud.com/en/case-studies/securitee/  
了解我们的合作伙伴SECURITEE如何利用OVHcloud产品组合提供机密计算解决方案。  
我们与OVHcloud的合作非常顺利高效。我们的联合产品可以说是市场上最安全且随时可用的云计算解决方案——这在欧洲市场是一个真正的首创。  
裸金属服务器、数据保护与隐私：来自Intel的Mike Ferron-Jones合作撰写。面对严峻的网络威胁环境，企业正在寻找新的数据保护和隐私解决方案及最佳实践。OVHcloud的新款Advance-6裸金属服务器配备了第三代Intel® Xeon®可扩展处理器（以前代号为“Ice Lake”）和Intel®软件保护扩展（Intel SGX）。这些技术提供了更高的性能，并利用机密计算来实现数据隐私、法规遵从性和更强的数据保护。阅读本文以了解更多关于机密计算的信息以及如何从中受益。  
现代业务转型的核心在于数据处理能力的提升。随着世界变得更加互联，企业面临数据收集、使用和存储的增长。为了应对这一挑战，云和数据分析等新解决方案不断涌现，正在改变业务运营方式。然而，如果忽视安全问题，这些变化也可能带来更大的风险。我们认为，安全、隐私和合规性必须与业务转型并行推进。因此，我们使用Intel® SGX构建了Advance-6裸金属服务器——它为客户提供了机密计算和增强的数据保护。虽然磁盘和网络加密可以在数据存储或传输时提供保护，但传统上，在数据被CPU和内存使用时是脆弱的。Intel SGX创建了硬件保护的“飞地”，旨在在数据使用时屏蔽数据和代码免受未经授权的方或软件的侵害。飞地内的数据和代码对云管理员或软件堆栈不可访问，从而帮助组织遵守GDPR和其他法规的要求。  
通过机密计算应对安全挑战变得尤为重要。企业数据正面临黑客、未经授权的第三方和恶意内部人员的更大威胁，他们经常利用应用程序中的漏洞，或操作系统和虚拟机监控程序层中的特权提升。随着软件安全性的提高，攻击者开始向下移动到堆栈中寻找新的漏洞，这使得商业机密或受监管的数据面临风险。数据泄露可能导致严重的经济损失和声誉损害。这意味着外围防御已不再足够。需要的是多层次的防御策略，使成功执行攻击变得不可行。机密计算技术对于此类策略至关重要，因为它使用基于硬件的方法将数据隔离在可信飞地中并在内存中对其进行加密。这可以保护数据免受操作系统和虚拟机监控程序层中的漏洞的影响，并确保即使具有完全访问权限的用户也无法在没有密钥的情况下解密数据。  
机密计算也是“合规计算”。欧洲在隐私和数据保护方面处于世界领先地位，处理个人或受监管数据的组织需要采取措施来最小化违规或违反的风险。这意味着部署行业最佳实践和最新的隐私保护技术，以维护数据安全、主权和控制。使用Intel SGX的机密计算可以成为合规制度的关键部分，并有助于降低监管风险。即使是像OVHcloud这样的云提供商也无法访问飞地内受保护的数据。此外，OVHcloud提供认证服务，使客户能够获得加密验证，确认其工作负载运行在真正的Intel SGX硬件上，微代码是最新的，软件负载正是预期的。认证有助于确保客户的数据受到保护并符合规定。  
Advance-6裸金属服务器提供了增强的性能，同时使解决方案能够快速大规模部署。它受益于PCIe Gen4和数据中心级NVMe磁盘，从而提高了带宽。OVHcloud链路聚合功能使两台服务器的物理网络链接能够聚合，以实现最佳网络速度。Advance-6服务器还包含第三代Intel® Xeon®可扩展处理器，该处理器通过Intel® 10nm工艺提高了每核性能。它们还包含驱动机密计算的技术——Intel® SGX。Intel® SGX在CPU级别内置，使数据能够在可信的加密飞地中隔离。Intel® SGX还提供：即使操作系统/驱动程序/BIOS/VMM/SMM被破坏，也能防止攻击；即使攻击者完全控制平台，也能增加对秘密（数据/密钥/密码）的保护；防御针对内存总线窥探、内存篡改和针对RAM的“冷启动”攻击。  
以下是一些机器学习和密码学中的示例：  
安全多方计算  
组织经常需要协作，但由于保密或法规原因，共享数据是被禁止的。安全多方计算是一种隐私保护技术，使多方能够汇集他们的数据并产生更准确的结果，同时保持每个方的数据对其他方的私密性。各方都可以使用认证功能来验证其“数据洁净室”是否正常运行并且软件是他们所期望的。Intel SGX今天用于多党医疗研究和金融欺诈检测用例。  
联邦学习  
联邦学习是一种隐私保护机器学习（PPML）方法，它将算法部署到分散的设备或站点，以便从太大或太敏感而无法移动到公共数据洁净室的数据中创建联合分析。在这种用例中，算法在进行分析时受到Intel SGX飞地的保护。去除任何私人信息后，结果会传递到中央节点，与其他节点的结果结合，并将新的权重或参数推送到远程模型。这确保敏感数据不会暴露于威胁，并帮助组织构建更准确的模型。  
2023年7月24日，AMD发布了一份安全公告，披露了其Zen2计算机处理器微架构中的一个漏洞。该漏洞被AMD命名为“跨进程信息泄露”，也被称为“Zenbleed”。该漏洞被标记为CVE-2023-20593，并被AMD评为中等严重程度。此问题允许攻击者在特定情况下访问CPU处理的敏感信息。所有运行在基于AMD Zen2处理器上的软件，包括虚拟机、沙箱、容器和进程，都会受到影响。利用此漏洞的软件可能已经存在，预计基于此漏洞的攻击很快就会发生。  
所有AMD Zen2 CPU，包括EPYC Rome处理器，都存在此漏洞，具体包括：  
- AMD Ryzen 3000系列处理器  
- AMD Ryzen PRO 3000系列处理器  
- AMD Ryzen Threadripper 3000系列处理器  
- 带有Radeon显卡的AMD Ryzen 4000系列处理器  
- 带有Radeon显卡的AMD Ryzen PRO 4000系列处理器  
- 带有Radeon显卡的AMD Ryzen 5000系列处理器  
- 带有Radeon显卡的AMD Ryzen 7020系列处理器  
- 第二代AMD EPYC “Rome”处理器  
对OVHcloud产品的影响  
针对这一事件，我们立即审查了安全公告和技术信息，并确定了以下对我们产品可能产生的影响。  
- 公共云：所有产品未受影响  
- 托管私有云：所有产品未受影响  
- 网站托管与域名：所有产品未受影响  
- 裸机云：ADVANCE-1, Advance STOR-1, Advance STOR-2, Game-1, Game-2, HGR-SDS-2, HGR-HCI-4, HGR-HCI-5, HGR-HCI-6, Infra-2, Rise-GAME-1, Rise-GAME-2, Scale-1, Scale-2, Scale-3（仅限由AMD Zen2驱动的服务器）可能受影响  
- 其他商用系列专用服务器：未受影响  
如何缓解漏洞：  
- 客户自行缓解：通过固件包更新在启动时加载修补的微代码。此解决方案将通过操作系统更新（例如linux-firmware包）触发处理器微代码的更新。您可以在您的操作系统编辑器或社区分发更新包后进行操作。此方法取决于您的发行版或操作系统编辑器，并且只有在AMD提供了适当的微代码时才有效。目前，只有“Zen2 Rome”和“Zen2 Castle Peak”可以通过此方法覆盖。  
- 使用更新的内核缓解：当无法通过固件更新包获得微代码更新时，您可以更新内核版本，通过配置所谓的“chicken bit”来禁用故障处理器功能以实现缓解。这可能会影响系统的性能。此解决方案将在操作系统编辑器回传新版本的Linux内核时包含。我们建议客户优先采用此缓解策略，因为这是最有效的，不依赖于硬件供应商是否提供更新的微代码。  
- 作为替代方案，您可以手动设置chicken bit而不依赖内核更新。然而，我们不推荐这种可能对系统有风险的解决方案。  
OVHcloud发起的缓解措施  
OVHcloud团队正在努力实施透明的解决方案，确保客户的修补微代码以透明的方式更新。这些解决方案将逐步部署到我们的服务器上。目前正在评估两个主要选项。  
- 使用OVHcloud iPXE：当客户使用标准的OVHcloud网络启动（最常见的配置）时，引导加载程序可能会加载微代码更新。一旦可用，通过OVHcloud客户界面重启服务器将导致在从磁盘启动之前加载更新的微代码，从而缓解漏洞。但是，如果您不使用OVHcloud网络启动系统直接从磁盘启动，则不会应用缓解措施，您应该考虑依赖操作系统级别的缓解措施。  
- 使用UEFI：UEFI固件更新可能在启动时更新CPU微代码。包括修补微代码的UEFI固件更新可能会在未来几个月内由主板制造商提供。一旦可用，OVHcloud将在任何新交付的服务器上包含此修补微代码。客户随后可以通过联系支持请求UEFI固件更新。  
作为潜在受影响服务器的管理员，我该怎么办？  
首先，使用我们团队开发的工具（仅限Linux）检查您的服务器是否受到此漏洞的影响：  
# wget https://raw.githubusercontent.com/speed47/spectre-meltdown-checker/master/spectre-meltdown-checker.sh  
# sh spectre-meltdown-checker.sh --variant zenbleed --explain  
如果工具显示“NOT VULNERABLE”（未受影响），则您已经安全，无需进一步行动。  
如果工具显示“VULNERABLE”（受影响），则应评估您面临威胁的程度。